<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html manifest="/application.manifest">
<head>
  <title>Nothing Calendar</title>
  <link href='./stylesheets/main.css' rel='stylesheet' type='text/css' /> 
  <script src="./javascripts/jquery-1.4.2.min.js"></script>
  <script src="./javascripts/jquery.calendar-widget.js"></script>
  <script>window.JSON = null;</script>
  <script src="./javascripts/json2.js"></script>
  <script src="./javascripts/lawnchair-0.6.1.min.js"></script>
  <script src="./javascripts/lawnchair-adapter-webkit-sqlite-0.6.1.js"></script>
  <script src="./javascripts/lawnchair-adapter-indexed-db-0.6.1.js"></script>

</head>

<body>
  <div class='wrap'>
  <div class="title">NothingCalendar</div>
  <div class="subtitle">Tracks occurences of some event.</div>

  <div id="calendar">
    <p>Please enable Javascript to view this calendar.</p>
  </div>
   

  <hr>
  <p>
    Inspired by <a href="http://calendaraboutnothing.com">Calendar
  About Nothing</a>, in fact sharing open source <a href="https://github.com/entp/seinfeld">code</a>.
  </p>
  </div>
  <script>
  //setup offline storage
  var marks_store = new Lawnchair({name:'marks', adaptor:'dom indexed-db webkit-sqlite window-name'}, function(marks) {});  
  $(function(){
    //display calendar
    $("#calendar").calendarWidget({});

    $('.current-month, .other-month').live('click', function(){
      if($(this).hasClass('xmarksthespot')) {
        $(this).toggleClass('xmarksthespot');
        marks_store.remove($(this).attr('class'), function() {});
      } else {
        marks_store.save({key:$(this).attr('class'),val:true});
        $(this).toggleClass('xmarksthespot');
      }
    });
  
    marks_store.all(function(items) {
      items.forEach(function(item) {
        console.log(item.key);
        $("."+item.key.replace(/ /g,'.')).addClass('xmarksthespot');
      });
    });
  
  });
  </script>
</body>
</html>